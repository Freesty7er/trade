Процедура ФоноваяПроцедураОбновленияРеквизитовПодчиненныхЭлементовСправочника(родитель) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	запрос = Новый Запрос;
	
	#Область ТекстЗапроса
	
	запрос.Текст =
	"ВЫБРАТЬ
	|	Номенклатура.Ссылка
	|ИЗ
	|	Справочник.Номенклатура КАК Номенклатура
	|ГДЕ
	|	Номенклатура.Ссылка В ИЕРАРХИИ(&Родитель)";
	
	#КонецОбласти
	
	запрос.УстановитьПараметр("Родитель", родитель);
	
	результатЗапроса = запрос.Выполнить();
	
	Если результатЗапроса.Пустой() Тогда
		Возврат;
	КонецЕсли;
	
	НачатьТранзакцию();
	
	блокировкаДанных = Новый БлокировкаДанных;
	
	элементБлокировки = блокировкаДанных.Добавить("Справочник.Номенклатура");
	элементБлокировки.Режим = РежимБлокировкиДанных.Исключительный;
	элементБлокировки.ИсточникДанных = результатЗапроса;
	элементБлокировки.ИспользоватьИзИсточникаДанных("Ссылка", "Ссылка");
	
	блокировкаДанных.Заблокировать();
	
	выборка = результатЗапроса.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкамСИерархией);
	Пока выборка.Следующий() Цикл
		
		справочникОбъект = выборка.Ссылка.ПолучитьОбъект();
		
		справочникОбъект.ОбменДанными.Загрузка = Истина;
		
		справочникОбъект.Поставщик = родитель.Поставщик;
		справочникОбъект.СчетУчета = родитель.СчетУчета;
		
		справочникОбъект.Записать();
		
	КонецЦикла;

	ЗафиксироватьТранзакцию();
	
КонецПроцедуры