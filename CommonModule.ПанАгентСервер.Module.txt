
#Область РегламентныеЗаданияОбмена

Процедура ПанАгентФормированиеОчередиОбмена() Экспорт
	
	РегистрыСведений.ПанАгентОчередьОбменаДанными.СформироватьОчередьОбменаДанными();
	
КонецПроцедуры

Процедура ПанАгентВыполнениеОчередиОбмена() Экспорт
	
	//ЗапуститьВыполнениеОчередиОбменаДанными();
	
	//ключЗадания = "ПанАгентВыполнениеОчередиОбменаДанными";
	//ключЗадания = Метаданные.РегламентныеЗадания.ПанАгентВыполнениеОчередиОбмена.Ключ;
	ключЗадания = "ВыполнениеОчередиОбменаДанными";
	активныеФоновыеЗадания = ФоновыеЗадания.ПолучитьФоновыеЗадания(Новый Структура("Ключ,Состояние", ключЗадания, СостояниеФоновогоЗадания.Активно));
	
	Если активныеФоновыеЗадания.Количество() = 0 Тогда
		ФоновыеЗадания.Выполнить("ПанАгентСервер.ВыполнитьОчередьОбменаДанными",, ключЗадания, НСтр("ru = 'Выполнение очереди обмена данными'"));
	КонецЕсли;	
	
КонецПроцедуры

#КонецОбласти

#Область ОчередьОбмена

// Обрабатывает очередь обмена данными и выполняет операции выгрузки и загрузки
// данных согласно параметрам очереди. Всегда выполняются только те задания, у
// которых реквизит ЗаданиеАктивно = Истина. Задания выполняются по убыванию даты
// добавления. Первыми выполняются задания с высоким приоритетом.
//
Процедура ВыполнитьОчередьОбменаДанными() Экспорт

	выполнениеОбменаДанными = Обработки.ПанАгентВыполнениеОбменаДанными.Создать();
	выполнениеОбменаДанными.ВыполнитьОчередьОбменаДанными();

КонецПроцедуры // ВыполнитьОчередьОбменаДанными()

#КонецОбласти
