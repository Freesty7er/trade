

&НаКлиенте
Процедура СписокПриАктивизацииСтроки(элемент)
	
	текущаяСтрока = Элементы.Список.ТекущаяСтрока;
	
	Если Не текущаяСтрока = Неопределено Тогда
		
		Если ТекущаяСтрокаСписка <> текущаяСтрока Тогда
			
			ТекущаяСтрокаСписка = текущаяСтрока;
			
			HTMLПросмотрАнкеты = БПАГ.ПолучитьHTMLАнкеты(элемент.ТекущаяСтрока, КаталогОбмена);
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПолеПросмотрАнкетыПриНажатии(Элемент, ДанныеСобытия, СтандартнаяОбработка)
	
	Попытка
		ФайлКартинки = ДанныеСобытия.Element.href;
		КодВопроса = ДанныеСобытия.Element.alt;
		
		Если Лев(ФайлКартинки, СтрДлина("file:///")) = "file:///" Тогда
			ФайлКартинки = Сред(ФайлКартинки, СтрДлина("file:///") + 1);
			
			МассивФото = БПАГ.ПолучитьМассивКартинокАнкеты(Элементы.Список.ТекущаяСтрока, КодВопроса, КаталогОбмена);
			
			П = Новый Структура;
			П.Вставить("ТекущееФото", ФайлКартинки);
			П.Вставить("МассивФото", МассивФото);
			П.Вставить("ЗаголовокГалереи", БПАГ.ПолучитьЗаголовокГалереиКартинок(КодВопроса));

			ОткрытьФорму("ОбщаяФорма.БПАГФормаПросмотраКартинок", П);
			
		КонецЕсли;
	Исключение
	КонецПопытки;
		
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	КаталогОбмена = БПАГ.БПАГПолучитьНастройку("1СКаталогОбмена");
КонецПроцедуры


