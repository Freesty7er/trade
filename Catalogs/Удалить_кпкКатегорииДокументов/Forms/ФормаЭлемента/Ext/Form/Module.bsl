
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Цвет = Объект.Ссылка.Цвет.Получить();  		
	Если ЗначениеЗаполнено(Объект.Ссылка) Тогда
		Цвет = Объект.Ссылка.Цвет.Получить();
	Иначе
		ЗначениеКопирования = Неопределено;
		Параметры.Свойство("ЗначениеКопирования", ЗначениеКопирования);
		Если ЗначениеКопирования <> Неопределено Тогда
			Цвет = ЗначениеКопирования.Цвет.Получить();
		Иначе
			Цвет = Новый Цвет(0, 0, 0);	
		КонецЕсли;
		
		СписДокументов.ЗаполнитьПометки(Истина);
		
	КонецЕсли;
		
	ЗаполнитьСписокВыбораВидаДокумента();
	
	СтрДокументы = Объект.ВидыДокументов + ",";
	Пока Найти(СтрДокументы, ",") > 0 Цикл		
		Поз = Найти(СтрДокументы, ",");
		стДок = Лев(СтрДокументы, Поз-1);
		
		ИскомаяСтрока = СписДокументов.НайтиПоЗначению(стДок);
		Если Не ИскомаяСтрока = Неопределено Тогда    		
			ИскомаяСтрока.Пометка = Истина;
		КонецЕсли;
		
		СтрДокументы = Сред(СтрДокументы, Поз + 1);    	
	КонецЦикла; 	
	
КонецПроцедуры

&НаСервере
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)
	
	ТекущийОбъект.Цвет = Новый ХранилищеЗначения(Цвет);

КонецПроцедуры

&НаСервере
Процедура ЗаполнитьСписокВыбораВидаДокумента()
	
	СписДокументов.Очистить();
	
	Если Объект.флДолги Тогда
		СписДокументов.Добавить("Заказ покупателя"           	  , "Заявка");
		СписДокументов.Добавить("Касса"                           , "Касса");
	Иначе   		
		СписДокументов.Добавить("Задание агента" 				  , "Задание");
		СписДокументов.Добавить("Заказ покупателя"           	  , "Заявка");
		СписДокументов.Добавить("Касса"                           , "Касса");
		СписДокументов.Добавить("Мерчендайзинг"                   , "Мерчендайзинг");
		СписДокументов.Добавить("Посещение"						  , "Посещение");
	КонецЕсли;
	
КонецПроцедуры //ЗаполнитьСписокВыбораВидаДокумента()


&НаКлиенте
Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
	
	Объект.ВидыДокументов = "";
	Для Каждого СтрокаСписка Из СписДокументов Цикл
		Если СтрокаСписка.Пометка Тогда
			Объект.ВидыДокументов = Объект.ВидыДокументов + СтрокаСписка.Значение + ",";
		КонецЕсли;
	КонецЦИкла; 
	
	Объект.ВидыДокументов = Лев(Объект.ВидыДокументов, СтрДлина(Объект.ВидыДокументов)-1);	
	
КонецПроцедуры

