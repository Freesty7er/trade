
&НаСервере
Процедура ЗаполнитьНаОснованииСервер()
	
	КонтрагентВладелец = Список.Отбор.Элементы[0].ПравоеЗначение;
	
	Если ЗначениеЗаполнено(КонтрагентВладелец) И ЗначениеЗаполнено(КонтрагентОснование) Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	АвтоматическиеСкидки.Ссылка,
		|	АвтоматическиеСкидки.ПометкаУдаления,
		|	АвтоматическиеСкидки.Группа,
		|	АвтоматическиеСкидки.ПроцентСкидки,
		|	АвтоматическиеСкидки.ЦеноваяГруппа,
		|	АвтоматическиеСкидки.Представление
		|ИЗ
		|	Справочник.АвтоматическиеСкидки КАК АвтоматическиеСкидки
		|ГДЕ
		|	АвтоматическиеСкидки.Владелец = &Владелец
		|	И АвтоматическиеСкидки.ПометкаУдаления = ЛОЖЬ");
		
		Запрос.УстановитьПараметр("Владелец", КонтрагентОснование);
		
		
		Выборка = Запрос.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			
			АвтоСкидки = Справочники.АвтоматическиеСкидки.СоздатьЭлемент();
			ЗаполнитьЗначенияСвойств(АвтоСкидки, Выборка);
			АвтоСкидки.Владелец = КонтрагентВладелец;
			АвтоСкидки.Записать();
			
		КонецЦикла;
		
	КонецЕсли;
	
	
КонецПроцедуры

&НаКлиенте
Процедура ЗаполнитьНаОсновании(Команда)
	
	Результат = ОткрытьФормуМодально("Справочник.АвтоматическиеСкидки.Форма.ФормаЗаполненияНаОсновании", Новый Структура("Отбор", Список.Отбор), ЭтаФорма);
	
	а=1;
	
	Если НЕ Результат = Неопределено Тогда
		КонтрагентОснование = Результат.КонтрагентОснование;
		
		ЗаполнитьНаОснованииСервер();
		
		Элементы.Список.Обновить();
		
	КонецЕсли;
	
КонецПроцедуры
