&НаКлиенте
Перем КаталогОбмена;

&НаКлиенте
Перем ТекущаяСтрокаСписка;

&НаКлиенте
Процедура СписокПриАктивизацииСтроки(Элемент)
	ТекущаяСтрока = Элементы.Список.ТекущаяСтрока;
	Если ТекущаяСтрокаСписка <> ТекущаяСтрока Тогда
		ТекущаяСтрокаСписка = ТекущаяСтрока;
		HTMLПросмотр = БПАГ.ПолучитьHTMLМерчандайзинга(Элемент.ТекущаяСтрока, КаталогОбмена);
		HTMLПросмотрШапки = БПАГ.ПолучитьHTMLШапкиМерчандайзинга(Элемент.ТекущаяСтрока, КаталогОбмена);
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ПолеПросмотрПриНажатии(Элемент, ДанныеСобытия, СтандартнаяОбработка)
	
	Попытка
		ФайлКартинки = ДанныеСобытия.Element.href;
		КодТовара = ДанныеСобытия.Element.alt;
		
		Если Лев(ФайлКартинки, СтрДлина("file://")) = "file://" Тогда
			ФайлКартинки = Сред(ФайлКартинки, СтрДлина("file://") + 1);
			
			МассивФото = БПАГ.ПолучитьМассивКартинокМерчандайзинга(Элементы.Список.ТекущаяСтрока, КодТовара, КаталогОбмена);
			
			П = Новый Структура;
			П.Вставить("ТекущееФото", ФайлКартинки);
			П.Вставить("МассивФото", МассивФото);
			П.Вставить("ЗаголовокГалереи", БПАГ.ПолучитьЗаголовокГалереиКартинок(КодТовара));

			ОткрытьФорму("ОбщаяФорма.БПАГФормаПросмотраКартинок", П);
			
		КонецЕсли;
	Исключение
	КонецПопытки;
		
КонецПроцедуры

&НаКлиенте
Процедура ПолеПросмотрКартинокШапкиПриНажатии(Элемент, ДанныеСобытия, СтандартнаяОбработка)
	
	Попытка
		ФайлКартинки = ДанныеСобытия.Element.href;
		КодТовара = ДанныеСобытия.Element.alt;
		
		Если Лев(ФайлКартинки, СтрДлина("file:///")) = "file:///" Тогда
			ФайлКартинки = Сред(ФайлКартинки, СтрДлина("file:///") + 1);
			
			МассивФото = БПАГ.ПолучитьМассивКартинокШапкиМерчандайзинга(Элементы.Список.ТекущаяСтрока, КодТовара, КаталогОбмена);
			
			П = Новый Структура;
			П.Вставить("ТекущееФото", ФайлКартинки);
			П.Вставить("МассивФото", МассивФото);
			П.Вставить("ЗаголовокГалереи", БПАГ.ПолучитьЗаголовокГалереиКартинок(КодТовара));

			ОткрытьФорму("ОбщаяФорма.БПАГФормаПросмотраКартинок", П);
			
		КонецЕсли;
	Исключение
	КонецПопытки;
		
КонецПроцедуры

КаталогОбмена = БПАГ.БПАГПолучитьНастройку("1СКаталогОбмена");
