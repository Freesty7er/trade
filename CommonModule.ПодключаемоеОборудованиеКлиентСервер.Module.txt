
#Область ИнформационныеКарты

// Выполняет изменение реквизитов информационной карты при её ручной регистрации.
//
// Параметры:
//  ИнформационнаяКарта  - ДанныеФормыКоллекция, СправочникОбъект.ИнформационныеКарты - информационная
//                 карта, регистрируемая вручную.
//
Процедура ЗарегистрироватьИнформационнуюКартуВручную(информационнаяКарта) Экспорт

	информационнаяКарта.Р_НомерЧекаРегистрации = "Ручная";
	информационнаяКарта.Р_ДатаНачалаДействия = ТекущаяДата();

КонецПроцедуры // ЗарегистрироватьИнформационнуюКартуВручную()

#КонецОбласти

#Область ДополнительныеПроцедурыИФункции

// Расчитывает контрольный символ для штрих-кода EAN13.
//
// Параметры
//  ШтрихКод  - Строка - Штрих-код, для которого расчитывается контрольный символ.
//
// Возвращаемое значение:
//   Число   - Контрольный символ штрих-кода.
//
Функция КонтрольныйСимволEAN13(ШтрихКод) Экспорт

	// Сложим цифры, стоящие на чётных и нечётных местах.
	СуммаЧётныхЦифр = 0;
	СуммаНечётныхЦифр = 0;
	Для к = 1 По 12 Цикл
		
		ТекЧисло = Число(Сред(ШтрихКод, к, 1));
		Если к % 2 = 0 Тогда
			СуммаЧётныхЦифр = СуммаЧётныхЦифр + ТекЧисло;
		Иначе
			СуммаНечётныхЦифр = СуммаНечётныхЦифр + ТекЧисло;
		КонецЕсли;
		
	КонецЦикла;
	
	КонтрольныйСимвол = 10 - Число(Прав(Строка((СуммаЧётныхЦифр * 3) + СуммаНечётныхЦифр), 1));
	КонтрольныйСимвол = ?(КонтрольныйСимвол = 10, 0, КонтрольныйСимвол);
	
	Возврат КонтрольныйСимвол;

КонецФункции // КонтрольныйСимволEAN13()

#КонецОбласти
