
#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	стПараметрыПечати = Новый Структура;
	ФормаОбъекта = ПараметрыВыполненияКоманды.Источник;
	// Если печать выполняется из формы документа, то получим текущую выбранную строку таблицы "Маршруты".
	Если ТипЗнч(ФормаОбъекта) = Тип("УправляемаяФорма")
		И ФормаОбъекта.ИмяФормы = "Документ.РИНКАЙПланМаршрута.Форма.ФормаДокумента" Тогда
		
		Маршруты = ФормаОбъекта.Элементы.Маршруты;
		Если Маршруты.ВыделенныеСтроки.Количество() > 0 Тогда
			
			ДанныеСтроки = ФормаОбъекта.Объект.Маршруты.НайтиПоИдентификатору(Маршруты.ВыделенныеСтроки[0]);
			стПараметрыПечати.Вставить("НомерСтрокиМаршрута", ДанныеСтроки.НомерСтроки);
		
		КонецЕсли; 
	
	КонецЕсли; 
	УправлениеПечатьюКлиент.ВыполнитьКомандуПечати("Документ.РИНКАЙПланМаршрута", "МаршрутныйЛист", ПараметрКоманды, ПараметрыВыполненияКоманды, стПараметрыПечати);
	
КонецПроцедуры

#КонецОбласти
